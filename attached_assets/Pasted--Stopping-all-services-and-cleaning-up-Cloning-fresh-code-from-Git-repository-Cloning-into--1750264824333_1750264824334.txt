
Stopping all services and cleaning up...
Cloning fresh code from Git repository...
Cloning into '.'...
remote: Enumerating objects: 2713, done.
remote: Counting objects: 100% (2713/2713), done.
remote: Compressing objects: 100% (904/904), done.
remote: Total 2713 (delta 1982), reused 2513 (delta 1782), pack-reused 0 (from 0)
Receiving objects: 100% (2713/2713), 2.35 MiB | 18.35 MiB/s, done.
Resolving deltas: 100% (1982/1982), done.
Creating production server...
Installing PostgreSQL driver...

npm error code EACCES
npm error syscall open
npm error path /var/www/itservicedesk/package.json
npm error errno -13
npm error Error: EACCES: permission denied, open '/var/www/itservicedesk/package.json'
npm error     at async open (node:internal/fs/promises:639:25)
npm error     at async writeFile (node:internal/fs/promises:1216:14)
npm error     at async PackageJson.save (/usr/lib/node_modules/npm/node_modules/@npmcli/package-json/lib/index.js:250:14)
npm error     at async init (/usr/lib/node_modules/npm/node_modules/init-package-json/lib/init-package-json.js:125:5)
npm error     at async Init.template (/usr/lib/node_modules/npm/lib/commands/init.js:168:20)
npm error     at async Init.exec (/usr/lib/node_modules/npm/lib/commands/init.js:48:5)
npm error     at async Npm.exec (/usr/lib/node_modules/npm/lib/npm.js:207:9)
npm error     at async module.exports (/usr/lib/node_modules/npm/lib/cli/entry.js:74:5) {
npm error   errno: -13,
npm error   code: 'EACCES',
npm error   syscall: 'open',
npm error   path: '/var/www/itservicedesk/package.json'
npm error }
npm error
npm error The operation was rejected by your operating system.
npm error It is likely you do not have the permissions to access this file as the current user
npm error
npm error If you believe this might be a permissions issue, please double-check the
npm error permissions of the file and its containing directories, or try running
npm error the command again as root/Administrator.
npm error A complete log of this run can be found in: /home/ubuntu/.npm/_logs/2025-06-18T16_39_46_629Z-debug-0.log
npm error code EACCES
npm error syscall mkdir
npm error path /var/www/itservicedesk/node_modules
npm error errno -13
npm error Error: EACCES: permission denied, mkdir '/var/www/itservicedesk/node_modules'
npm error     at async mkdir (node:internal/fs/promises:858:10)
npm error     at async /usr/lib/node_modules/npm/node_modules/@npmcli/arborist/lib/arborist/reify.js:624:20
npm error     at async Promise.allSettled (index 0)
npm error     at async [reifyPackages] (/usr/lib/node_modules/npm/node_modules/@npmcli/arborist/lib/arborist/reify.js:325:11)
npm error     at async Arborist.reify (/usr/lib/node_modules/npm/node_modules/@npmcli/arborist/lib/arborist/reify.js:142:5)
npm error     at async Install.exec (/usr/lib/node_modules/npm/lib/commands/install.js:150:5)
npm error     at async Npm.exec (/usr/lib/node_modules/npm/lib/npm.js:207:9)
npm error     at async module.exports (/usr/lib/node_modules/npm/lib/cli/entry.js:74:5) {
npm error   errno: -13,
npm error   code: 'EACCES',
npm error   syscall: 'mkdir',
npm error   path: '/var/www/itservicedesk/node_modules'
npm error }
npm error
npm error The operation was rejected by your operating system.
npm error It is likely you do not have the permissions to access this file as the current user
npm error
npm error If you believe this might be a permissions issue, please double-check the
npm error permissions of the file and its containing directories, or try running
npm error the command again as root/Administrator.
npm error A complete log of this run can be found in: /home/ubuntu/.npm/_logs/2025-06-18T16_39_47_226Z-debug-0.log
Created symlink /etc/systemd/system/multi-user.target.wants/itservicedesk.service ‚Üí /etc/systemd/system/itservicedesk.service.
Waiting for fresh deployment to start...
Testing fresh deployment...
‚úó Health check failed
Jun 18 16:40:05 ip-172-31-85-178 itservicedesk[163195]:     at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
Jun 18 16:40:05 ip-172-31-85-178 itservicedesk[163195]:   code: 'EADDRINUSE',
Jun 18 16:40:05 ip-172-31-85-178 itservicedesk[163195]:   errno: -98,
Jun 18 16:40:05 ip-172-31-85-178 itservicedesk[163195]:   syscall: 'listen',
Jun 18 16:40:05 ip-172-31-85-178 itservicedesk[163195]:   address: '127.0.0.1',
Jun 18 16:40:05 ip-172-31-85-178 itservicedesk[163195]:   port: 5000
Jun 18 16:40:05 ip-172-31-85-178 itservicedesk[163195]: }
Jun 18 16:40:05 ip-172-31-85-178 itservicedesk[163195]: Node.js v20.19.2
Jun 18 16:40:05 ip-172-31-85-178 systemd[1]: itservicedesk.service: Main process exited, code=exited, status=1/FAILURE
Jun 18 16:40:05 ip-172-31-85-178 systemd[1]: itservicedesk.service: Failed with result 'exit-code'.
‚úó Frontend issue
‚óè itservicedesk.service - Calpion IT Service Desk - Fresh Deployment
     Loaded: loaded (/etc/systemd/system/itservicedesk.service; enabled; vendor preset: enabled)
     Active: activating (auto-restart) (Result: exit-code) since Wed 2025-06-18 16:40:05 UTC; 4s ago
    Process: 163195 ExecStart=/usr/bin/node server-production.js (code=exited, status=1/FAILURE)
   Main PID: 163195 (code=exited, status=1/FAILURE)
        CPU: 47ms

=== FRESH DEPLOYMENT COMPLETE ===

üåü Your Calpion IT Service Desk is now running fresh from Git!

üîó Access: https://98.81.235.7
üë§ Login: john.doe / password123
üìä Database: Connected with all your data
üîß Changes screen: Will display data (no more blank screen)
‚ö° Server: Pure Node.js (no module conflicts)

‚úÖ All previous module errors eliminated
‚úÖ Fresh code deployment from repository
‚úÖ Clean systemd service configuration